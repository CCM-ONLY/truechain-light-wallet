"use strict";

//页面跳转
mui.plusReady(function() {
	let host = plus.storage.getItem('web3Host');
	if(!host) {
		host = "https://mainnet.infura.io/";
	}

	(function() {
		var web3 = new Web3(new Web3.providers.HttpProvider(host));

		var Wallet = {
			init: function init() {
				//页面跳转
				this.turnUrl(".e-setup", "setup.html", "setup");
				this.turnUrl(".e-import", "importwallet.html", "importwallet");

				//获取资产情况
				var addresses = plus.storage.getItem('walletAddress'),
					balance = web3.fromWei(web3.eth.getBalance(addresses), 'ether');
				balance = Math.round(balance * 10000) / 10000;

				//钱包列表
				let string = `<li class='mywallet'>
					<section>
						<i class="avatar"></i>
						<div class="wallet-info">
							<p class="title">${plus.storage.getItem('walletName')}</p>
							<p class="code">${plus.storage.getItem('walletAddress')}</p>
						</div>
						<span class="mui-navigate-right"></span>
					</section>
					<section>
						<span>${balance}<i>ether</i></span>
					</section>
				</li>`;
				$('.wallet-list').append(string);
				this.turnUrl(".mywallet", "../../asset/userinfo.html", "userinfo");
			},
			turnUrl: function turnUrl(elements, url, id) {
				$(elements).on('tap', function() {
					openInfo(url, id);
				});
			}
		};
		Wallet.init();
	})();

})